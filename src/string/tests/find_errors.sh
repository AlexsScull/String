#!/bin/bash

# =============================================
# Скрипт для анализа ошибок в исходном файле
# 
# Назначение:
# Анализирует файл с ошибками (например, вывод компилятора) и извлекает
# номера строк, в которых встречаются ошибки для указанного исходного файла.
#
# Как пользоваться:
# 1. Запустите скрипт с двумя аргументами:
#    ./script.sh <file_with_error_> <Файл с ошибкой (как в компиляторе)>
#    Например: ./find_errors.sh compile_errors.txt tests/test_sprintf.c
#
# 2. Результат сохраняется в файл errors.txt
#
# Результат:
# Отсортированный список уникальных номеров строк с ошибками
# =============================================

if [ $# -ne 2 ]; then
    echo "Usage: $0 <file_with_error_> <Файл с ошибкой (как в компиляторе)"
    exit 1
fi

file_with_error_="$1"
source_file="$2"
output_file="errors.txt"

# Извлекаем номера строк с ошибками, сортируем и сохраняем в файл
grep -E "^${source_file}:[0-9]+:[0-9]+:" "$file_with_error_" | \
awk -F: '{print $2}' | \
sort -un > "$output_file"

echo "Список строк с ошибками сохранён в: $output_file"